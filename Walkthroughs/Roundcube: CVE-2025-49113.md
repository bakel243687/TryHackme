# Roundcube: CVE-2025-49113

I just walked through this room on TryHackMe and it spoke to me. It was interesting even though I didn't know much on PHP serialization as at the time of this writeup. Many people see TryHackMe as a game or a place for just CTF, it also provides environment to test Common Vulnerabilities and Exposures (CVE) with support resource like the proof of concept (PoC) for these CVEs or details on other CVEs related to the case study based on the room on hte platform

## Understand Serialization
Serialization is the process of converting an object into a storable or transmittable format. For those familiar with databases, APIs or cookies, this is used in storing objects in files or databases and for sending objects across the network in APIs or cookies. In the case of deserialization, data (like byte streams) is converted into program objects. In scenarios where the process of deserialization is done insecurely, attackers can abuse the serialised data to  execute codes or do take more malicious actions like escalate privileges.

More on serialization can be seen in the reference

In short, the vulnerability is caused by the insecured deserialization of the _from property in the upload.php. The connection between the property and the endpoint is quite crazy and reading the technical details by Fearoff would be of good help

A detailed technical research by Fearsoff on the roundcube vulnerability can be seen here: [Link](https://fearsoff.org/research/roundcube)

In addition, viewing the commit to the versions affected wouldn't kill even if you don't or don't fully understand PHP like me. The [commit for version 1.5.10](https://github.com/roundcube/roundcubemail/commit/7408f31379666124a39f9cb1018f62bc5e2dc695#diff-e941e729aef9ce9f97dde65bc93b160e6f972cd8731e0dc2002cb34f95e5675bR35) and [for version 1.6.11](https://github.com/roundcube/roundcubemail/commit/0376f69e958a8fef7f6f09e352c541b4e7729c4d)

I viewed it and I can't say I wasn't confused but we would get something from it after all. **The Unknown shall be Known**

## Exploit
Apparently, we would not have to go through the long process that the security researchers at Fearsoff went through as they have provided a php code that does all that in their [GitHub Repository](https://github.com/fearsoff-org/CVE-2025-49113)

What next? 

We just follow the Proof of Concept as the provided PHP code crafts the malicious serialised PHP object, embeds the crafted object in the _from parameter adn send a POST request to the upload.php endpoint using the malicious _from parameter


Now I execute the script with the current login detail I have and also a bind shell at the end of the command. It takes a short time to run and the payload is successfully injected. Interesting


Getting a shell using netcat and the port of the bind shell in the previous shell gives my the access to the server.

I could cruise through the linux server directories and see all users and running services on the server. This vulnerability is quite a handful


## Preventive measures.
The only prevention is an update to current versions of Roundcube except you want to change webmail software.
